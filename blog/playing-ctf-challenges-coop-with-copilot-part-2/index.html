<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.111.3"><link rel=icon href=/images/icon.jpg><title>Playing CTF Challenges Co-op With Copilot (Part 2) | Douglas Hellinger</title><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot-part-2/enigma-copilot-typewriter-cover.jpg"><meta name=twitter:title content="Playing CTF Challenges Co-op With Copilot (Part 2)"><meta name=twitter:description content="Let&rsquo;s see if we can apply what we learned in the previous article to greater effect&mldr;
Krypton5: Crack The Vigenère Cipher From 3 Intercepted Ciphertexts Let&rsquo;s play krypton5."><meta property="og:title" content="Playing CTF Challenges Co-op With Copilot (Part 2)"><meta property="og:description" content="Let&rsquo;s see if we can apply what we learned in the previous article to greater effect&mldr;
Krypton5: Crack The Vigenère Cipher From 3 Intercepted Ciphertexts Let&rsquo;s play krypton5."><meta property="og:type" content="article"><meta property="og:url" content="https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot-part-2/"><meta property="og:image" content="https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot-part-2/enigma-copilot-typewriter-cover.jpg"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-10-06T14:23:19+08:00"><meta property="article:modified_time" content="2024-10-05T07:23:19+08:00"><link href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css rel=stylesheet integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.0.13/css/all.css integrity=sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp crossorigin=anonymous><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel=stylesheet><link rel=stylesheet href=https://www.douglashellinger.com/css/medium.a3d5489836b19de22a81ddc6bd21c17547d07529e67b266427378a04fa3ea727.css integrity="sha256-o9VImDaxneIqgd3GvSHBdUfQdSnmeyZkJzeKBPo+pyc="><link rel=stylesheet href=https://www.douglashellinger.com/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk="></head><body><nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down"><div class="container pr-0"><a class=navbar-brand href=https://www.douglashellinger.com/><img src=/images/icon.jpg alt=logo></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarMediumish aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarMediumish><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/blog>Blog</a></li><li class=nav-item><a class=nav-link href=/explainer>Explainers</a></li><li class=nav-item><a class=nav-link href=/food>Food</a></li><li class=nav-item><a class=nav-link href=/how-to>How to Guides</a></li><li class=nav-item><a class=nav-link href=/>About</a></li></ul></div></div></nav><div class=site-content><div class=container><div class=mainheading><h1 class=sitetitle>Douglas Hellinger</h1><p class=lead>Helping you have fun and maximise impact by learning containers and kubernetes!</p></div><div class=main-content><div class=container><div class=row><div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset"><p>Share</p><ul><li class="ml-1 mr-1"><a target=_blank href="https://twitter.com/intent/tweet?text=Playing%20CTF%20Challenges%20Co-op%20With%20Copilot%20%28Part%202%29&url=https%3a%2f%2fwww.douglashellinger.com%2fblog%2fplaying-ctf-challenges-coop-with-copilot-part-2%2f" onclick='return window.open(this.href,"twitter-share","width=550,height=435"),!1'><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a target=_blank href="https://facebook.com/sharer.php?u=https%3a%2f%2fwww.douglashellinger.com%2fblog%2fplaying-ctf-challenges-coop-with-copilot-part-2%2f" onclick='return window.open(this.href,"facebook-share","width=550,height=435"),!1'><i class="fab fa-facebook-f"></i></a></li><li class="ml-1 mr-1"><a target=_blank href="https://www.xing.com/spi/shares/new?url=https%3a%2f%2fwww.douglashellinger.com%2fblog%2fplaying-ctf-challenges-coop-with-copilot-part-2%2f" onclick='return window.open(this.href,"xing-share","width=550,height=435"),!1'><i class="fab fa-xing"></i></a></li></ul><div class=sep></div><ul><li><a class="small smoothscroll" href=#disqus_thread></a></li></ul></div></div><div class="col-md-9 flex-first flex-md-unordered"><div class=mainheading><div class="row post-top-meta"><div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right"><img class=author-thumb src=/images/profile.jpg alt="Douglas Hellinger"></div><div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left"><a target=_blank class=link-dark>Douglas Hellinger</a><br><span class=author-description>Creator of this blog.<br><i class="far fa-star"></i>
Oct 6, 2024
<i class="far fa-clock clock"></i>
6 min read</span></div></div><h1 class=posttitle>Playing CTF Challenges Co-op With Copilot (Part 2)</h1></div><img class="featured-image img-fluid" src=https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot-part-2/enigma-copilot-typewriter-cover.jpg alt="thumbnail for this post"><div class=article-post><p>Let&rsquo;s see if we can apply what we learned in the <a href=../playing-ctf-challenges-coop-with-copilot/>previous article</a> to greater effect&mldr;</p><h2 id=krypton5-crack-the-vigenère-cipher-from-3-intercepted-ciphertexts>Krypton5: Crack The Vigenère Cipher From 3 Intercepted Ciphertexts</h2><p>Let&rsquo;s play krypton5. We&rsquo;ll give Copilot the context of the challenge, excluding the solution from krypton4.Let us see where it leads&mldr;</p><blockquote><p>Note: This article masks the true key under <a href=https://overthewire.org/rules>OverTheWire&rsquo;s rules</a>.</p></blockquote><p>After logging in, we see the following files:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>krypton5@bandit:/krypton/krypton5$ l
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>found1  found2  found3  krypton6  README
</span></span></code></pre></div><h2 id=share-the-problem-statement-with-copilot>Share The Problem Statement With Copilot</h2><p>First, let&rsquo;s share the context with Copilot.</p><p>Copy all the files from the krypton5 directory and open them in the editor so that copilot has the context.</p><p>Here&rsquo;s what the README says:</p><p><img src=image-8.png alt="alt text"></p><h2 id=attach-the-readme-to-the-prompt-and-ask-copilot-to-solve-the-challenge>Attach The README To The Prompt And Ask Copilot To Solve The Challenge</h2><p>Let&rsquo;s write a prompt to set the context and highlight the information given:</p><blockquote><p>solve the challenge described in #file:README. #file:found1, #file:found2, #file:found3 and #file:krypton6 are vigenere ciphertexts encrypted with the same key.</p><p>create a plan to solve it. Share the steps to be executed on the terminal.</p></blockquote><p>Copilot shared this plan:</p><p><img src=image-6.png alt="alt text"></p><p>Seems viable. But let&rsquo;s look at the plan in more detail&mldr;
We have to apply some knowledge about the problem domain.</p><h2 id=apply-the-context-you-know-to-the-responses>Apply The Context You Know To The Responses</h2><p>First, we can&rsquo;t concatenate the ciphertexts!</p><p>We assume the ciphertexts were encrypted separately and both start with the same key. If we concatenate them, the key will be skewed, and the frequency analysis will be skewed.</p><p>To understand more, let&rsquo;s look at this example where we can see both the ciphertext and plaintext:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-t data-lang=t><span style=display:flex><span><span style=color:#f92672>------------|------</span>
</span></span><span style=display:flex><span>plaintext1  <span style=color:#f92672>|</span> TODAY
</span></span><span style=display:flex><span>key         <span style=color:#f92672>|</span> GOLDG
</span></span><span style=display:flex><span>ciphertext1 <span style=color:#f92672>|</span> ZCODE
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-t data-lang=t><span style=display:flex><span><span style=color:#f92672>------------|---------</span>
</span></span><span style=display:flex><span>plaintext2  <span style=color:#f92672>|</span> TOMORROW
</span></span><span style=display:flex><span>key         <span style=color:#f92672>|</span> GOLDGOLD
</span></span><span style=display:flex><span>ciphertext2 <span style=color:#f92672>|</span> ZCXRXFZZ
</span></span></code></pre></div><p>If we concatenate <code>ciphertext1</code> and <code>ciphertext2</code>, watch what happens when we decrypt with the correct repeated key:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-t data-lang=t><span style=display:flex><span><span style=color:#f92672>-------------|--------------</span>
</span></span><span style=display:flex><span>ciphertext   <span style=color:#f92672>|</span> ZCODEZCXRXFZZ
</span></span><span style=display:flex><span>key          <span style=color:#f92672>|</span> GOLDGOLDGOLDG
</span></span><span style=display:flex><span>plaintext    <span style=color:#f92672>|</span> TODAYLRULJUWT
</span></span></code></pre></div><p><code>plaintext1</code> is the correct, but <code>plaintext2</code> is incorrect. This is because the key is skewed. <code>plaintext2</code> has been decrypted starting with &lsquo;O&rsquo;, the 2nd character of the key. That differs from how it was encrypted, where the key started with &lsquo;G&rsquo;.</p><p>So we can only concatenate the ciphertexts if we pad the plaintext to exact multiple of the key length.
Since we don&rsquo;t know the key length, we cant do that.</p><p>Let&rsquo;s feed back to Copilot:</p><blockquote><p>we can only concatenate the ciphertexts if we pad the plaintext to exact multiple of the key length.
since we don&rsquo;t know the key length, we cant do that.</p><p>the ciphertexts were encrypted separately and both start with the same key. If we concatenate them, the key will be skewed, and the frequency analysis will be skewed.</p></blockquote><p>Copilot made some small iterations on the plan. In particular, it removed the step to concatenate the ciphertexts. It also stripped newlines and spaces from the ciphertexts.</p><h2 id=ask-again-if-it-missed-something>Ask Again If It Missed Something</h2><p>Copilot omitted the <code>find_key_length</code> function. Let&rsquo;s ask to include it the generated code.</p><blockquote><p>implement the find_key_length method. state any more assumptions on the plan.</p></blockquote><p>Copilot responded with code we can test.
I love that it stated the assumptions it made.</p><p><img src=image-7.png alt="alt text"></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> Counter
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_ic</span>(text):
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> len(text)
</span></span><span style=display:flex><span>    frequency <span style=color:#f92672>=</span> Counter(text)
</span></span><span style=display:flex><span>    ic <span style=color:#f92672>=</span> sum(f <span style=color:#f92672>*</span> (f <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> frequency<span style=color:#f92672>.</span>values()) <span style=color:#f92672>/</span> (n <span style=color:#f92672>*</span> (n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ic
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find_key_length</span>(ciphertext):
</span></span><span style=display:flex><span>    <span style=color:#75715e># Use Index of Coincidence to find key length</span>
</span></span><span style=display:flex><span>    possible_key_lengths <span style=color:#f92672>=</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>21</span>)
</span></span><span style=display:flex><span>    average_ics <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> key_length <span style=color:#f92672>in</span> possible_key_lengths:
</span></span><span style=display:flex><span>        ics <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(key_length):
</span></span><span style=display:flex><span>            nth_letters <span style=color:#f92672>=</span> ciphertext[i::key_length]
</span></span><span style=display:flex><span>            ics<span style=color:#f92672>.</span>append(calculate_ic(nth_letters))
</span></span><span style=display:flex><span>        average_ics<span style=color:#f92672>.</span>append(sum(ics) <span style=color:#f92672>/</span> len(ics))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># The key length with the highest average IC is likely the correct one</span>
</span></span><span style=display:flex><span>    likely_key_length <span style=color:#f92672>=</span> possible_key_lengths[average_ics<span style=color:#f92672>.</span>index(max(average_ics))]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> likely_key_length
</span></span></code></pre></div><h2 id=iterate-on-the-script-in-the-editor-not-in-the-chat>Iterate On The Script In The Editor, Not In The Chat</h2><p>Let&rsquo;s move to the editor and get something executing&mldr;</p><p>It failed on the first run. But it just needed the input filenames to be lowercase.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    files <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;found1&#39;</span>, <span style=color:#e6db74>&#39;found2&#39;</span>, <span style=color:#e6db74>&#39;found3&#39;</span>, <span style=color:#e6db74>&#39;krypton6&#39;</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> files:
</span></span><span style=display:flex><span>        process_file(file)
</span></span></code></pre></div><p>Wowza! it executed fast!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ python3 vigenere_decrypt.py
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Determined Key <span style=color:#66d9ef>for</span> found1: YEYAECCTRKEYLEJGTH
</span></span><span style=display:flex><span>Decrypted Text <span style=color:#66d9ef>for</span> found1: UTWLSELERESTOFXIMEEITHADXHUWORSTSFTIYESTTHESJHEAGESFWIEDOXIEAAITHEAGIOFFAOLTSSREISITWAWTHEQPONHZJBULIEFIXWASFHEPPZGHEFINCRIDULUTYTTHESJHESEAWONORLIRHEMTMASTHEWEASANOQDLVKDESSITAASTTESARTRGEFHOPEMTWAETHPWTRTUROFDEWPAIDWESAOIVURYTHIRGBERORPUDAEXADNOTLINGNEFZRPYSMEWEREELLGAINRDTVESTTOHEEVENIEWPRPELBGOINGHIREOTTSEZXHURWAYIRSHODTTSEAIRYODWASWOFADLIVEELEFRESENXPERUODEHLXSEMEOFIXSNOUSIPSEEUJHORITMESIZSIDTPHODITSBEMNGRQCETVPHFERGOODSRFODEVTLTRTXESUPEVLATUVEOERVEUOFCOMTARIEONZNWCTXEREWEVEAKUNGHIELABARGEJEWANPAQFEPRWYTHAPLEINFMCEZNELEJHRONESFENSLAYDELEHEWEREEKINSWIEHLPAHGEJAWENDACUEPNHMTXAFAIRJACEANTSEELRENEOFFVANCQINMOELCEUNTRIISITIASNLPERURTHANGRYSFALEOELEBORDSOJTHEETAEEAVEIERVESSFLOMVEDAYHFYSHESTLATTTINRSTRGUNERALAEREEETELPHFEREVERMTWAETHPYPEREFOURLSRDOZETSOFWADDSEVERHUNPREOAYHSUVENTYJIVEEPICIEYABREVELETIOZSWPRPGODCEDEDXOENSLAYDLXTXATFAVSUREPPECIZHAIATTHIWMRSEOUEHNSTJHADREGENTXYAETLMNUDHERFMVEAZDTHEYXIUTHBLEWSEDNIREHOEYEFWHOMEPROBHEEINTRYVATEIRTHEXIFPGFERTSHADHIRALPEDEHPWURLIMEATPEADANNEMCADNOUNCMNGTTATLRCENWEMENTWWERQMAOEQSRJHESWAPLOWUNGFPZJLENDONARDWEETMTNDXEHEVENTLECOOKLLNPKHESTHADFEENXAIOOYPYQROUNDHOZEZOFJELVSQFTERREPPIZGOFTTXSCESSAGISASFHEDPTVIJSOFTHMSVEDYYPACPAITPASTWUPEDNAEUCELBYDEFIGIENFINZRTKIDALITYVAPPQDOFTELEYRSMERIMESEAGPSTRTXEEARTLLYODDECOQIVUNTSHAHLATQLYNOXITETHEENKLISTCRZWYENTPEOPLIFROYACZNRVEISOFBRMTISTSUMJPGTIINAMEVICAIHINHDXRQNGETOVELAFEHLVPTREVEDMOVEIMBOREAYXTETHEHUQANRMCEEHLRADYCOMMYNICMTIZNDCEJRECEIZEDTTROFGSENOOFTHEGHICWENDOQXHUCOCKLENEBDOOO
</span></span><span style=display:flex><span>Determined Key <span style=color:#66d9ef>for</span> found2: KOYLENVTQ
</span></span><span style=display:flex><span>Decrypted Text <span style=color:#66d9ef>for</span> found2: WXENTHPMRIBGOTSFCTEISFULWYKOTOVERTNKHUCOURDEFFJHEFOCEEOENTHESERDTRAWECAKTXEROYLLXEERGEHZTVLEPENEOTYESOACHOOFRQSHISNUJTEMWASSEUITITWIEHJOCEFLOFRZSXOFCECEDODYFORLMRIBJOURYEPFHOMLOYDFNYNWINEEIWQSANANHZELEMENETFCENGRAEUCAJEANAOVVNJUROUDTIALELLECUGODBYTHLTKICETHECENAIONLYZNVATVENTFRFUITRAVPLCEHLEFTMETODGRATFLRTUDFOREHVTMOOTHPRJHQDBEEYSVTTOWNAETYEYRRESAETTYVEROLDJITEDESEIEAJIONSEHVMYLDEWJIESYDEOFEHVCEACHWTTYIJSDAMAAEDTIRTYDTIAMITSDTSRGUEABLPSDEBLANDTTJORSCURTTPWQSRATSEILYKEALLRXEHDOGKPNEEBMRLOCRPTXEPASDEEGURSHAVIEGXIMSEWFFUJOFITTNTHQINSOQSKRQWATAYGCEEFSHARGPWHAPPECFCAFPINGSAKADDMUDOYCEWSWASCAKHURLIKPACAHGERSZRKOVDOGTSEIEMILLBPAGASKETTZCRLQISTOXOIREWDRAHEIYUSSIRTFKHUWEATSEIHELDSAYDKHUWINDDEKSJOLERLBCEVAIRTSEKITEWILWSVRLEPREETPNYCELYLTRBEUTTWZIETXEAFTPREOENSIRMEUSYRISHLLCNETGOTZBVDJILLNTGYTRUTIWLNKAREDROZMRNTABARMEIADDTHEYBIEQKFASESZROESSICTYAJWAYSTRZFOOUPLPAJEIHOWCZNTOHDGENELVMQNSVAWIJEQNDHOEWRTURTOCZNTOHDPULWOWFWENTLPMRNIBOOTDIECENCOROYFUMILLFTNUAVINESPATOQLFIRPSZRVETCHMAIBURTOCZNTOHDSTICASOKTTHECEEOMFORCZNTOHDTHENOECERDBEOCYACBERBPIEGQLWAYDAJSYGNEDEORPQSSENREIBOTHEMLICADDPASDEEGURSBYEHVMQILBETNXABWAYSSERVYLYWRLPGETUPFRZMYEQDTOFZOKTXEROOXHRDJHEODOIETURESTQOITXEESTLBCIIHMENEOWTXEROYLLXEERGETSAKABTHOURHSUJONEKTNUOVMANWLSJEUNTOGZIETEITALWKZNTSANDGAIIUTIESZFDEDCAMEZUKOVITCOYSVQKENTLJAEOJHERDCANEHANDTHOGOHTERSLNUSUVERAWMRITSANDEHVLQNDLAOYNEHEALLWOZTURINGMYRCSIDENEAKVQRIOUDPFIDTSOFEHVREADBEEWVEDTHECZNTOHDANDEHVCEFFEECOFMMHENAREETBEMANZFJINTYFOCMRLBYDREDSVDYNABRZWESKITOFNLFTXESPRPTKYMELLWZREBKTVERJWVLBKEPTHIKHBARGEDQLAHECUFQSRNTLARGPFCAFSTOTSEGOSKETSAAJSUDALOYGFNXISWAJTFHYSBRELKWAIT
</span></span><span style=display:flex><span>Determined Key <span style=color:#66d9ef>for</span> found3: YEULDXGTQKENLECGXH
</span></span><span style=display:flex><span>Decrypted Text <span style=color:#66d9ef>for</span> found3: HEVYPHDEILYLNDXEPHADMCBBHECOOVEDHIPHMHENEENERCHVNEPAJDMLSUEMATTHTTCKTNCAEOROSEUSJERXONFNZEDHMSGBAPGEDHAIDTYOMTESUXOUXHIEPIETADUTWGSQVIKYAYDLZNCEHIXYBWAIESTEHEWERIFYENEUVAEESNENNEKFFHIBSYSKWIRPHESAZASOSDMUGAEDWLSAWIPTXEZAJDOFZTFZRHTSXRAWRSUECKZNGDFIETADELIELQNDTLODEAYDSEDESFBVINVTEITUCEDIESLOFIANUBUNKLPSPOATLOVWHPCAIYWECEPRUMLEXERERNOODLTTPLQSPEFACRZSPQLAIEJWUGWEUJINXVECYCWOOEFOLITXEAUWHTCHHICIFIWTPREPIESFMEOWWSYAHEPVHAZRBFTWSIYHXOSKFTFAIMOCEADTDOGGLIUMERVSPFNFCOIFULEMFDTSFFSTLKZRCLMSWHJILIEENEHOFGDNATSFBVINVNEDSIYAYCARHAOSEWZTHSISDTKCWIRGTMASRSWSITPAOTTEXOQIOFKHEHAVPSPHMTFRPAEUGONEHEYEEGTBSUSYNGSEANHOCTDEEPICLIOFJAIWTHLTCLUNXEEYNTYESFNLTGDTRAVAUIEARFANEHLBETGAPLZIUPGREDSEOAJDCUMEUUDWRSSEILWLEGTTIDVFUNUEREHEBUWIZTAIHRYAGAICOFXOESFBVIHXTEPESEHAEIPMGSXHBLECFSTEHETRKWZEVIOOEAISGZNEMYOOYETAJDSTFDRTLLEOPHQCSMQESEUANOREDENVQDIXQHESJIOYOFEEHLEORSCQNKYEHLDASEWLFHCCPBOUIINSISNHAEWSENEXISWACPTHZUCHXIREERORVFEHTRLCASAFENYYETPBUEPECHWPETLEDENFZDEYTILLXAOHILPHCLVRKDINEEHLEORSCQNKNERPPRTNYIBAPLZECCLPIPDWTTDTTEGASUSOWOTSERAEKPXEENEFERYAPDSENOJDTARDDQREJLIVESPCKNPHENESLOKHEDCOXEAAEIPYPVFAEDOYCOXPHEFIRGIYSRVSEXBLLNYEFOEMBDWHFWADSIETENSFSRIYSPFRTCAIEMNLARVYEHOPGEDZFFEOOLQETTIUARIIVLLOQHESNRIALVASKROFSEOHEMMNHHFIAIUTOEHEORWWQRESIUMOMEDSISNHWIDTSIUYWIJHANCOXMKDMTMOOFREGARPDFZRWYAURGMQDYNHOXAYNOIETEVEBJANPTIXETZDWYEHIMBOASBFOCMRUANVUSPOSHYOISHPMAJOJLKAWKGERAXENELEXAJFDOQTFBLSFNSMANVPHEMSITPBETDEKYOWJEOSURXEMBSOESBLNKTNHOZDSNTYRYVSYPSSTRSETAZEPVTEETIXESEHAHANSUSJOEETECTATNUOGRKEOJLEDENTNTSEERFREVFBLIEGBLCKHANDEARDGERWRRDDBEEWEXFLSNEENAEDPLRIDSERMVESUTEACOFERAGEHLUNKSJHINKELWSOYAJDOOQPBDYSYOUDEYPSSEMRIQVYTERFRPNCSHKUEEESXULLRSAYENRLESTOREZUSSZRNZTMFCDIZTLEIQBIKOFDUCSTNAHEPLJDGYFURDELQIPHUNOSJHNOKOFWATPYAADSMTJIFIWTEPNYPANSEIRCFMESZNCPICLMALMSXFSEMFIANNE
</span></span></code></pre></div><p>Looking at the output, there are some insights!
Especially looking at the keys it determined!</p><p>Where do we go from here..?</p><h2 id=play-to-copilots-strengths>Play To Copilot&rsquo;s Strengths</h2><p>The resulting plaintexts don&rsquo;t make much sense to me.
But we have a language model that&rsquo;s great at cryptanalysis! Let&rsquo;s ask Copilot to guess what the plaintext might be&mldr;</p><p><img src=image-3.png alt="alt text"></p><p>Copilot used its strength to generate the most likely plaintexts.</p><p><img src=image-9.png alt="alt text"></p><p>Great!</p><p>So let&rsquo;s ask it to adjust the key in correlation with the predicted plaintext.</p><p><img src=image-4.png alt="alt text"></p><p>Ha! Responsible AI filter!</p><h2 id=play-to-copilots-weaknesses>Play To Copilot&rsquo;s Weaknesses</h2><p>So we can&rsquo;t blatantly ask for the key. Instead, we can ask for the difference between the partially decrypted plaintext and the target plaintext.</p><p><img src=image-10.png alt="alt text"></p><p>Copilot&rsquo;s response wasn&rsquo;t what I expected, but it does help towards the desired outcome.</p><p><img src=image-12.png alt="alt text"></p><p>It compared the two plaintexts and stated the shifts between them, character by character.</p><p><img src=image-13.png alt="alt text"></p><p>This enables us to see how many shift places the key is off by and adjust the key accordingly. It decided to compare the first 100 characters, which you may feel a bit noisy. Let&rsquo;s followed up with this prompt:</p><blockquote><p>state the first 20 differences again. quantify the shift, modulo 26.</p></blockquote><p><img src=image-14.png alt="alt text"></p><p>Next, I asked it to apply those shifts to &lsquo;AAAAAAAAAAAAAAAAAA&rsquo;. When the response came back, I realized that was a mistake. I should have asked it to apply the shifts to the key instead.</p><blockquote><p>apply the same shifts to &ldquo;YEYAECCTRKEYLEJGTH&rdquo;</p></blockquote><p><img src=image-11.png alt="alt text"></p><p>hmmm, now part of the key looks like an english word.</p><p>Let&rsquo;s ask Copilot to &ldquo;guess the english sentence&rdquo; (we wont mention its a key!).</p><p><img src=image-5.png alt="alt text"></p><p>Now we can apply the key directly to our script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>process_file</span>(filename):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(filename, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        ciphertext <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39; &#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># key_length = find_key_length(ciphertext)</span>
</span></span><span style=display:flex><span>    key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;REDACTED&gt;&#34;</span> <span style=color:#75715e>#find_key(ciphertext, key_length)</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Determined Key for </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>key<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    decrypted_text <span style=color:#f92672>=</span> decrypt_vigenere(ciphertext, key)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Decrypted Text for </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>decrypted_text<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>&mldr;and run it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>➜ python3 vigenere_decrypt.py 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Determined Key <span style=color:#66d9ef>for</span> found1: MEYPEYRBTKEYLEFGTH
</span></span><span style=display:flex><span>Decrypted Text <span style=color:#66d9ef>for</span> found1: GTWWSIWWPESTOFBIME
</span></span></code></pre></div><p>hmmm, look at the resulting plaintext aligned below the applied key. The 2nd part corresponds to the target plaintext from Charles Dickens. The first part is gibberish.</p><p>What if the key length is wrong?</p><p>The code assumes the key length is up to 20 characters. But its a cryptography puzzle. Perhaps its shorter..?</p><p>Let&rsquo;s try <code>&lt;REDACTED></code> as the key:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>➜ python3 vigenere_decrypt.py
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Determined Key <span style=color:#66d9ef>for</span> found1: &lt;REDACTED&gt;
</span></span><span style=display:flex><span>Decrypted Text <span style=color:#66d9ef>for</span> found1: ITWASTHEBESTOFTIMESITWASTHEWORSTOFTIMESITWASTHEAGEOFWISDOMITWASTHEAGEOFFOOLISHNESSITW
</span></span></code></pre></div><p>Finally, lets apply the key to <code>krypton6</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Determined Key <span style=color:#66d9ef>for</span> krypton6: &lt;REDACTED&gt;
</span></span><span style=display:flex><span>Decrypted Text <span style=color:#66d9ef>for</span> krypton6: &lt;REDACTED&gt;
</span></span></code></pre></div></div><div class=after-post-tags><ul class=tags><li><a href=/tags/github>github</a></li><li><a href=/tags/ai>AI</a></li><li><a href=/tags/programming>programming</a></li><li><a href=/tags/ctf>ctf</a></li><li><a href=/tags/cybersecurity>cybersecurity</a></li><li><a href=/tags/security>security</a></li><li><a href=/tags/overthewire>overthewire</a></li><li><a href=/tags/problem-solving>problem-solving</a></li></ul></div><div class="row PageNavigation d-flex justify-content-between font-weight-bold"><a class="d-block col-md-6" href=https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot-part-3/>&#171; Playing CTF Challenges Coop With Copilot (Part 3)</a>
<a class="d-block col-md-6 text-lg-right" href=https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot/>Playing CTF Challenges Co-op With Copilot &#187;</a><div class=clearfix></div></div></div></div></div><div class=container><div id=comments class="row justify-content-center mb-5"><div class=col-md-8></div></div></div></div></div><div class="jumbotron fortags"><div class="d-md-flex h-100"><div class="col-md-4 transpdark align-self-center text-center h-100"><div class="d-md-flex align-items-center justify-content-center h-100"><h2 class="d-md-block d-none align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2></div></div><div class="col-md-8 p-5 align-self-center text-center"><a class="mt-1 mb-1" href=/tags/429>429</a>
<a class="mt-1 mb-1" href=/tags/ai>ai</a>
<a class="mt-1 mb-1" href=/tags/build-pipeline>build-pipeline</a>
<a class="mt-1 mb-1" href=/tags/builder-image>builder-image</a>
<a class="mt-1 mb-1" href=/tags/chart>chart</a>
<a class="mt-1 mb-1" href=/tags/cloud>cloud</a>
<a class="mt-1 mb-1" href=/tags/container>container</a>
<a class="mt-1 mb-1" href=/tags/containers>containers</a>
<a class="mt-1 mb-1" href=/tags/copilot>copilot</a>
<a class="mt-1 mb-1" href=/tags/crd>crd</a>
<a class="mt-1 mb-1" href=/tags/cri>cri</a>
<a class="mt-1 mb-1" href=/tags/ctf>ctf</a>
<a class="mt-1 mb-1" href=/tags/cybersecurity>cybersecurity</a>
<a class="mt-1 mb-1" href=/tags/deployment>deployment</a>
<a class="mt-1 mb-1" href=/tags/distribution>distribution</a>
<a class="mt-1 mb-1" href=/tags/dockerhub>dockerhub</a>
<a class="mt-1 mb-1" href=/tags/docs-as-code>docs-as-code</a>
<a class="mt-1 mb-1" href=/tags/drag-drop>drag-drop</a>
<a class="mt-1 mb-1" href=/tags/driver>driver</a>
<a class="mt-1 mb-1" href=/tags/encryption>encryption</a>
<a class="mt-1 mb-1" href=/tags/food>food</a>
<a class="mt-1 mb-1" href=/tags/github>github</a>
<a class="mt-1 mb-1" href=/tags/gpg>gpg</a>
<a class="mt-1 mb-1" href=/tags/helm>helm</a>
<a class="mt-1 mb-1" href=/tags/kubernetes>kubernetes</a>
<a class="mt-1 mb-1" href=/tags/limit>limit</a>
<a class="mt-1 mb-1" href=/tags/markdown>markdown</a>
<a class="mt-1 mb-1" href=/tags/medium>medium</a>
<a class="mt-1 mb-1" href=/tags/navigation>navigation</a>
<a class="mt-1 mb-1" href=/tags/oci>oci</a>
<a class="mt-1 mb-1" href=/tags/outline>outline</a>
<a class="mt-1 mb-1" href=/tags/overthewire>overthewire</a>
<a class="mt-1 mb-1" href=/tags/pair-programming>pair-programming</a>
<a class="mt-1 mb-1" href=/tags/problem-solving>problem-solving</a>
<a class="mt-1 mb-1" href=/tags/programming>programming</a>
<a class="mt-1 mb-1" href=/tags/proxy>proxy</a>
<a class="mt-1 mb-1" href=/tags/rate>rate</a>
<a class="mt-1 mb-1" href=/tags/registry>registry</a>
<a class="mt-1 mb-1" href=/tags/reorder>reorder</a>
<a class="mt-1 mb-1" href=/tags/runtime>runtime</a>
<a class="mt-1 mb-1" href=/tags/security>security</a>
<a class="mt-1 mb-1" href=/tags/sigstore>sigstore</a>
<a class="mt-1 mb-1" href=/tags/stream-cipher>stream-cipher</a>
<a class="mt-1 mb-1" href=/tags/thinkpad>thinkpad</a>
<a class="mt-1 mb-1" href=/tags/too-many-requests>too-many-requests</a>
<a class="mt-1 mb-1" href=/tags/tree-view>tree-view</a>
<a class="mt-1 mb-1" href=/tags/troubleshooting>troubleshooting</a>
<a class="mt-1 mb-1" href=/tags/ubuntu>ubuntu</a>
<a class="mt-1 mb-1" href=/tags/verify>verify</a>
<a class="mt-1 mb-1" href=/tags/writing>writing</a></div></div></div><footer class=footer><div class=container><div class=row><div class="col-md-6 col-sm-6 text-center text-lg-left">&copy; Copyright Douglas Hellinger 2022 - Present</div><div class="col-md-6 col-sm-6 text-center text-lg-right"><a target=_blank rel=noopener href=https://www.wowthemes.net>Mediumish Theme</a> by WowThemes.net</div></div></div></footer></div><script src=https://code.jquery.com/jquery-3.4.1.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js integrity=sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script>
<script src=https://www.douglashellinger.com/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TEH3VGXMRY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TEH3VGXMRY",{anonymize_ip:!1})}</script></body></html>