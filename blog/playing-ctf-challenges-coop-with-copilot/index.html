<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.111.3"><link rel=icon href=/images/icon.jpg><title>Playing CTF Challenges Co-op With Copilot | Douglas Hellinger</title><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot/unicorn-pair-programmer-cover.jpg"><meta name=twitter:title content="Playing CTF Challenges Co-op With Copilot"><meta name=twitter:description content="Github Copilot is at the &ldquo;Peak of Inflated Expectations&rdquo; for many, including me. With all the Copilot hype, it&rsquo;s easy to imagine unicorns assisting programmers in their world of joy!"><meta property="og:title" content="Playing CTF Challenges Co-op With Copilot"><meta property="og:description" content="Github Copilot is at the &ldquo;Peak of Inflated Expectations&rdquo; for many, including me. With all the Copilot hype, it&rsquo;s easy to imagine unicorns assisting programmers in their world of joy!"><meta property="og:type" content="article"><meta property="og:url" content="https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot/"><meta property="og:image" content="https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot/unicorn-pair-programmer-cover.jpg"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-09-27T04:55:35+08:00"><meta property="article:modified_time" content="2024-08-31T08:04:35+08:00"><link href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css rel=stylesheet integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.0.13/css/all.css integrity=sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp crossorigin=anonymous><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel=stylesheet><link rel=stylesheet href=https://www.douglashellinger.com/css/medium.a3d5489836b19de22a81ddc6bd21c17547d07529e67b266427378a04fa3ea727.css integrity="sha256-o9VImDaxneIqgd3GvSHBdUfQdSnmeyZkJzeKBPo+pyc="><link rel=stylesheet href=https://www.douglashellinger.com/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk="></head><body><nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down"><div class="container pr-0"><a class=navbar-brand href=https://www.douglashellinger.com/><img src=/images/icon.jpg alt=logo></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarMediumish aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarMediumish><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/blog>Blog</a></li><li class=nav-item><a class=nav-link href=/explainer>Explainers</a></li><li class=nav-item><a class=nav-link href=/how-to>How to Guides</a></li><li class=nav-item><a class=nav-link href=/>About</a></li></ul></div></div></nav><div class=site-content><div class=container><div class=mainheading><h1 class=sitetitle>Douglas Hellinger</h1><p class=lead>Helping you have fun and maximise impact by learning containers and kubernetes!</p></div><div class=main-content><div class=container><div class=row><div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset"><p>Share</p><ul><li class="ml-1 mr-1"><a target=_blank href="https://twitter.com/intent/tweet?text=Playing%20CTF%20Challenges%20Co-op%20With%20Copilot&url=https%3a%2f%2fwww.douglashellinger.com%2fblog%2fplaying-ctf-challenges-coop-with-copilot%2f" onclick='return window.open(this.href,"twitter-share","width=550,height=435"),!1'><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a target=_blank href="https://facebook.com/sharer.php?u=https%3a%2f%2fwww.douglashellinger.com%2fblog%2fplaying-ctf-challenges-coop-with-copilot%2f" onclick='return window.open(this.href,"facebook-share","width=550,height=435"),!1'><i class="fab fa-facebook-f"></i></a></li><li class="ml-1 mr-1"><a target=_blank href="https://www.xing.com/spi/shares/new?url=https%3a%2f%2fwww.douglashellinger.com%2fblog%2fplaying-ctf-challenges-coop-with-copilot%2f" onclick='return window.open(this.href,"xing-share","width=550,height=435"),!1'><i class="fab fa-xing"></i></a></li></ul><div class=sep></div><ul><li><a class="small smoothscroll" href=#disqus_thread></a></li></ul></div></div><div class="col-md-9 flex-first flex-md-unordered"><div class=mainheading><div class="row post-top-meta"><div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right"><img class=author-thumb src=/images/profile.jpg alt="Douglas Hellinger"></div><div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left"><a target=_blank class=link-dark>Douglas Hellinger</a><br><span class=author-description>Creator of this blog.<br><i class="far fa-star"></i>
Sep 27, 2024
<i class="far fa-clock clock"></i>
9 min read</span></div></div><h1 class=posttitle>Playing CTF Challenges Co-op With Copilot</h1></div><img class="featured-image img-fluid" src=https://www.douglashellinger.com/blog/playing-ctf-challenges-coop-with-copilot/unicorn-pair-programmer-cover.jpg alt="thumbnail for this post"><div class=article-post><p>Github Copilot is at the &ldquo;Peak of Inflated Expectations&rdquo; for many, including me. With all the Copilot hype, it&rsquo;s easy to imagine unicorns assisting programmers in their world of joy!</p><p>Over the last few weekends, I sat down to deliberately pair with and learn about GitHub&rsquo;s AI pair programmer.</p><p>The exercise I had in mind was to play <a href=https://overthewire.org/wargames/>OverTheWire.org</a> - one player capture the flag (CTF) challenges you can play from the comfort of your own terminal. The challenges help you learn and practice security concepts. If you like escape rooms, you&rsquo;ll probably like these!</p><p>In this blog, I played the krypton wargame - a series of cryptography challenges. I wanted to see how Copilot could help solve the challenges.</p><p>After a few false starts, we managed to reveal the encryption key, decrypt all the ciphertexts, and find the password to the next level!</p><p>I found, if you engage Copilot Chat from the beginning with the problem statement, it helps get a result with less waste. Reference the files explicitly. Ask it to propose the solution. Ask it to share the steps. If you&rsquo;re open to the solution it suggests, even if its not what you had in mind, you can steer it.</p><p>I also found, you can&rsquo;t ignore the need to understand the problem and solution domain. You need to apply the context you know to the responses.</p><p>You can apply learnings from this article to:</p><ul><li>Work with Github Copilot in the Chat, Editor and Terminal.</li><li>Have fun learning Linux and security concepts with OverTheWire!</li><li>Crack a Vigenère cipher knowing only the key length.</li></ul><hr><h2 id=quick-orientation-to-overthewire>Quick Orientation To OverTheWire</h2><p>To show by example, let&rsquo;s play <a href=https://overthewire.org/wargames/krypton/krypton0.html>Krypton Level 0</a>. From the web page:</p><blockquote><p>Welcome to Krypton! The first level is easy. The following string encodes the password using Base64:</p><p>&ldquo;S1JZUFRPTklTR1JFQVQ=&rdquo;</p><p>Use this password to log in to krypton.labs.overthewire.org with username krypton1 using SSH on port 2231. You can find the files for other levels in /krypton/</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -p <span style=color:#ae81ff>2231</span> krypton1@krypton.labs.overthewire.org
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>                      _                     _              
</span></span><span style=display:flex><span>                     | | ___ __ _   _ _ __ | |_ ___  _ __  
</span></span><span style=display:flex><span>                     | |/ / <span style=color:#e6db74>&#39;__| | | | &#39;</span>_ <span style=color:#ae81ff>\|</span> __/ _ <span style=color:#ae81ff>\|</span> <span style=color:#e6db74>&#39;_ \ 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                     |   &lt;| |  | |_| | |_) | || (_) | | | |
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                     |_|\_\_|   \__, | .__/ \__\___/|_| |_|
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                |___/|_|                   
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                      This is an OverTheWire game server. 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            More information on http://www.overthewire.org/wargames
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>krypton1@krypton.labs.overthewire.org&#39;</span>s password: 
</span></span></code></pre></div><p>We&rsquo;re greeted by krypton ASCII art and asked for the password. If we decode (not decrypt) the base64-encoded string, we get the password.</p><p>The aim of the game is to find the password for the next level.</p><h2 id=krypton4-crack-the-vigenère-cipher-given-only-the-key-length>Krypton4: Crack The Vigenère Cipher Given Only The Key Length</h2><p>Let&rsquo;s skip a few levels and jump to krypton4. This level has enough complexity to show the value of Copilot.</p><blockquote><p>Note: This article masks the true key under <a href=https://overthewire.org/rules>OverTheWire&rsquo;s rules</a>.</p></blockquote><p>After logging in, we see the following files:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>krypton4@bandit:/krypton/krypton4$ l
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>found1  found2  HINT  krypton5  README
</span></span></code></pre></div><p>Here&rsquo;s what the README says:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-md data-lang=md><span style=display:flex><span>This level is a Vigenère Cipher.  You have intercepted two longer, english 
</span></span><span style=display:flex><span>language messages.  You also have a key piece of information.  You know the 
</span></span><span style=display:flex><span>key length!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>For this exercise, the key length is 6.  The password to level five is in the usual
</span></span><span style=display:flex><span>place, encrypted with the 6 letter key.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Have fun!
</span></span></code></pre></div><p>* the &ldquo;usual place&rdquo; is the file <code>krypton5</code>.</p><h2 id=share-the-problem-statement-with-copilot>Share The Problem Statement With Copilot</h2><p>First, let&rsquo;s share the context with copilot.</p><p>Copy all the krypton4 files from the krypton server and open them in the editor so that copilot has the context.</p><p><img src=image-13.png alt="alt text"></p><h2 id=failed-attempt-ask-copilot-to-solve-the-challenge-incrementally-in-the-editor>Failed Attempt: Ask Copilot To Solve The Challenge Incrementally In The Editor</h2><p>I started by trying to get copilot to write this article for me, using inline chat in markdown. That failed.</p><p>The main problem I observed is that it autocomplete the next step, but the suggested code wasn&rsquo;t correct.</p><p>Cycling through alternative suggestions didn&rsquo;t improve that much - it only had 2 suggestions!</p><p>I tried to improve the detail of prompt. For example</p><blockquote><p>&ldquo;Apply frequency analysis to column 1. Sort the output alphabetically. Show the frequency of each letter.&rdquo;</p></blockquote><p>But results were equally frustrating.</p><p>Perhaps copilot was missing the bigger picture of the whole problem statement and a prompt asking to solve it..?</p><h2 id=next-attempt-attach-the-readme-to-the-prompt-and-ask-copilot-to-solve-the-challenge>Next Attempt: Attach The README To The Prompt And Ask Copilot To Solve The Challenge</h2><p>Here&rsquo;s the prompt I gave chat:</p><blockquote><p>solve the challenge described in #file:README. show the steps to be executed on the terminal.</p></blockquote><p>The result was encouraging. It responded with a plan and steps to execute in the terminal!</p><p><img src=image-14.png alt="alt text"></p><h2 id=apply-the-context-you-know-to-the-responses>Apply The Context You Know To The Responses</h2><p>Let&rsquo;s follow the steps it gives&mldr;</p><p>Immediately I found a need to adapt the filenames and paths for the krypton environment.</p><p>Somehow Copilot missed the filenames <code>found1</code>, <code>found2</code> and <code>krypton5</code>, even though those files were open in the editor.</p><p>Next I had to create temp directory on krypton (you can&rsquo;t write, except to <code>/tmp</code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>mktemp -d
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/tmp/tmp.qMFHnR41zp/
</span></span></code></pre></div><p>I gathered this context by reading krypton welcome message. Copilot is missing that context, but you can just apply it instead of trying to feed it every detail.</p><p>Besides those differences, step 1 and 2 went well.</p><h2 id=ask-again-if-it-missed-something>Ask Again If It Missed Something</h2><p>In step 3 of its plan, Copilot asked me to calculate the shift for each column. But, it didn&rsquo;t show the terminal steps.</p><p><img src=image-5.png alt="alt text"></p><p>So let&rsquo;s ask again:</p><blockquote><p>please show the steps to calculate the shift for each column</p></blockquote><p>I remembered bash doesn&rsquo;t handle numbers well. And the generated code was hard for me to understand. I asked for an alternative solution in python.</p><p>This time it came back with a script long enough that it belonged in a file.</p><p>Save the script to a file in the krypton server.</p><p>But on execution, it failed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>krypton4@bandit:/krypton/krypton4$ python3 /tmp/tmp.qMFHnR41zp/calculate-shifts.py 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Traceback <span style=color:#f92672>(</span>most recent call last<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>File <span style=color:#e6db74>&#34;/tmp/tmp.qMFHnR41zp/calculate-shifts.py&#34;</span>, line 10, in &lt;module&gt;
</span></span><span style=display:flex><span>with open<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#39;freq_analysis_{i}.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span><span style=color:#f92672>)</span> as file:
</span></span><span style=display:flex><span>        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</span></span><span style=display:flex><span>FileNotFoundError: <span style=color:#f92672>[</span>Errno 2<span style=color:#f92672>]</span> No such file or directory: <span style=color:#e6db74>&#39;freq_analysis_1.txt&#39;</span>
</span></span></code></pre></div><p>Again, we have to adjust the file paths to the context of the krypton target environment.</p><h2 id=apply-the-context-you-know-to-the-responses-again>Apply The Context You Know To The Responses Again</h2><p>So we need to adjust the filepaths again. Let&rsquo;s ask copilot inline in the editor to set the temp directory to find input files.</p><blockquote><p>set to same as script dir by default.</p></blockquote><p>Now we need to replace the script in the target env again.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>krypton4@bandit:/krypton/krypton4$ python3 /tmp/tmp.qMFHnR41zp/calculate-shifts.py
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Column 1: Shift <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>Column 2: Shift <span style=color:#f92672>=</span> <span style=color:#ae81ff>17</span>
</span></span><span style=display:flex><span>Column 3: Shift <span style=color:#f92672>=</span> <span style=color:#ae81ff>19</span>
</span></span><span style=display:flex><span>Column 4: Shift <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>Column 5: Shift <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>Column 6: Shift <span style=color:#f92672>=</span> <span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>Determined key shifts: <span style=color:#f92672>[</span>5, 17, 19, 10, 4, 24<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>It runs!
But the output is unintuitive. You wanna see the key letter, not so much the shifts.</p><p>We can ask in chat</p><p><img src=image-6.png alt="alt text"></p><p>Now we got a script mod that ignored the path mods we just made - even though that script was open in the IDE.</p><h2 id=iterate-on-the-script-in-the-editor-not-in-the-chat>Iterate On The Script In The Editor, Not In The Chat</h2><p>Let&rsquo;s ask the same change, but inline on the editor&mldr;</p><p><img src=image-7.png alt="alt text"></p><p>Ah, this time it got it. The result has better separation of concerns too. The code that formats the output is independent of the code that opens files and calculates shifts!</p><p>Since there&rsquo;s a disconnect between the code in our IDE and the target env, we need to go back to edit in the terminal.</p><p>Great! Now we have the key letters!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Corresponding letters: <span style=color:#f92672>[</span><span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;A&#39;</span><span style=color:#f92672>]</span>
</span></span></code></pre></div><blockquote><p>Note: Key redacted to play by <a href=https://overthewire.org/rules>https://overthewire.org/rules</a>. It&rsquo;s not &lsquo;AAAAAA&rsquo;!</p></blockquote><p>That&rsquo;s the key according to frequency analysis. Let try using the key to decrypt the ciphertext&mldr; i.e. Step 4 of Copilot&rsquo;s master plan..!</p><h2 id=iterate-on-the-plan-in-the-chat-not-the-editor>Iterate On The Plan In The Chat, Not The Editor</h2><p>For step 4 of the plan, copilot chat had a bug in it&rsquo;s formatting:</p><p><img src=image-4.png alt="alt text"></p><p>Let&rsquo;s politely ask to repeat and fix the formatting:</p><p><img src=image-8.png alt="alt text"></p><p>This time we got a python script to decrypt a Vigenère cipher.</p><p>You may also notice copilot hinted (quite subtly) at a glaring vulnerability in the code - the key is hardcoded right next to the decrypt function!</p><p><img src=image-9.png alt="alt text"></p><blockquote><p>Feedback to <a href=https://github.com>Github</a>: The vulnerability hint is too subtle! What if Copilot enables people to configure the visibility and assertiveness of such hints?</p></blockquote><p>Let&rsquo;s look at the script and, once again, apply the context of our target env. This time we&rsquo;ll request a few changes incrementally in the editor:</p><blockquote><p>read ciphertext from stdin</p></blockquote><p><img src=image-10.png alt="alt text"></p><blockquote><p>take key as input arg to script</p></blockquote><p><img src=image-11.png alt="alt text"></p><p>Now I realise, we don&rsquo;t need to copy to the target env! We already copied the ciphertexts locally to give Copilot the context. Why don&rsquo;t we just apply that and skip the env disconnect?!</p><p>Here&rsquo;s the result of decrypting <code>found1</code> with the key &lsquo;AAAAAA&rsquo;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat found1 | python3 decrypt-viginere-ciphertext.py AAAAAA
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>THPSOLDIPRWITHEHEGREPNWHISVERSLEOTHEMTSROUGHEHESTRPETSOFEHEEMECALDCIEYUNTIWTHEYRPACHEDEHEROOXWHEREEHEGUACDIANOQTHEGAEESLIVPDTHISZFFICECUNLOCVEDTHETRSPECEACLESEOPUTTSEMBACVINHISRREATBZXANDTSENHEPZLITELJOPENEOTHEGAEEFOROFRFRIEYDSWHINHROADWEADSTZTHEWINKEDWIECHOFTSEWESTLSKEDDZROTHYEHEREIDNOROAOANSWECEDTHERUARDILNOFTHPGATESYOONEEGERWISSESTOGZTHATWLYHOWTSENAREHETOFIYDHERIYQUIREOTHEGICLTHATHILLBEPASYREALIEDTSEMANFZRWHENDHEKNOHSYOUACEINTHPCOUNTCYOFTHPWINKIPSSHEWTLLFINOYOUANOMAKEYZUALLHPRSLAVPSPERHLPSNOTDAIDTHPSCARENROWFOCWEMEAYTODESEROYHECOHTHAEISDIFQERENTDAIDTHPGUARDTANOFTSEGATEDNOONESASEVECDESTRZYEDHECBEFORPSOINAEURALLJTHOUGSTSHEWZULDMAVESLAVPSOFYOFASSHESASOFTSERESTMUTTAKPCAREFZRSHEIDWICKEOANDFIPRCEANOMAYNOEALLOWJOUTODPSTROYSERKEEATOTHEHESTWHPRETHEDUNSETDANDYOFCANNOEFAILTZFINDHPRTHEYEHANKEOHIMANOBADEHTMGOODMYEANDEURNEDEOWARDEHEWESEWALKIYGOVERQIELDSZFSOFTRRASSDZTTEDHPREANDEHEREWTTHDAIDIESANOBUTTECCUPSDZROTHYDTILLWZRETHEARETTYDILKDRPSSSHESADPUTZNINTHPPALACPBUTNOHTOHERDURPRIDESHEFZUNDITHASNOLZNGERGCEENBUEPUREWSITETHPRIBBOYAROUNOTOTOSYECKHAOALSOLZSTITSRREENCZLORANOWASASHHITEADDOROTSYSDREDSTHEEXERALDNITYWADSOONLPFTFARMEHINDLSTHEYLDVANCPDTHEGCOUNDBPCAMERZUGHERLNDHILWIERFOCTHEREHERENOQARMSNZRHOUSPSINTHTSCOUNERYOFTSEWESTLNDTHERROUNDHASUNTTLLEDIYTHEAFEERNOOYTHESUYSHONESOTINTSEIRFANESFOREHEREWPRENOTCEESTOZFFERTSEMSHAOESOTHLTBEFOCENIGHEDOROTSYANDTZTOANDEHELIOYWERETTREDANOLAYDOHNUPONEHEGRADSANDFPLLASLPEPWITSTHEWOZDMANAYDTHESNARECRZWKEEPTNGWATNH
</span></span></code></pre></div><p>Hmmm this doesn&rsquo;t make sense. But you can see snippets of english in there. Actually its hard to read in all caps without punctuation.</p><p>One technique we can apply is to make the plaintext lowercase for the part of the key we&rsquo;re confident about. That way its easier to see the english words.</p><p>Copilot helped mod the script inline. Here&rsquo;s the result:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat found1 | python3 decrypt-viginere-ciphertext.py AAAaaa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>THPsolDIPrwiTHEhegREPnwhISVersLEOtheMTSrouGHEhesTRPetsOFEheeMECaldCIEyunTIWtheYRPachEDEherOOXwheREEhegUACdiaNOQtheGAEeslIVPdthISZffiCECunlOCVedtHETrspECEaclESEopuTTSembACVinhISRreaTBZxanDTSenhEPZlitELJopeNEOtheGAEefoROFrfrIEYdswHINhroADWeadSTZtheWINkedWIEchoFTSeweSTLskeDDZrotHYEherEIDnorOAOansWECedtHERuarDILnofTHPgatESYoonEEGerwISSestOGZthaTWLyhoWTSenaREHetoFIYdheRIYquiREOtheGIClthATHillBEPasyREAlieDTSemaNFZrwhENDhekNOHsyoUACeinTHPcouNTCyofTHPwinKIPsshEWTllfINOyouANOmakEYZualLHPrslAVPspeRHLpsnOTDaidTHPscaRENrowFOCwemEAYtodESEroyHECohtHAEisdIFQereNTDaidTHPguaRDTanoFTSegaTEDnooNESaseVECdesTRZyedHECbefORPsoiNAEuraLLJthoUGStshEWZuldMAVeslAVPsofYOFassHESasoFTSereSTMuttAKPcarEFZrshEIDwicKEOandFIPrceANOmayNOEallOWJoutODPstrOYSerkEEAtotHEHestWHPretHEDunsETDandYOFcanNOEfaiLTZfinDHPrthEYEhanKEOhimANObadEHTmgoODMyeaNDEurnEDEowaRDEhewESEwalKIYgovERQielDSZfsoFTRrasSDZtteDHPreaNDEherEWTthdAIDiesANObutTECcupSDZrotHYDtilLWZretHEAretTYDilkDRPsssHESadpUTZninTHPpalACPbutNOHtohERDurpRIDeshEFZundITHasnOLZngeRGCeenBUEpurEWSiteTHPribBOYaroUNOtotOSYeckHAOalsOLZstiTSRreeNCZlorANOwasASHhitEADdorOTSysdREDsthEEXeraLDNityWADsooNLPftfARMehiNDLsthEYLdvaNCPdthEGCounDBPcamERZughERLndhILWierFOCtheREHereNOQarmSNZrhoUSPsinTHTscoUNEryoFTSeweSTLndtHERrouNDHasuNTTlleDIYtheAFEernOOYtheSUYshoNESotiNTSeirFANesfOREherEWPrenOTCeesTOZffeRTSemsHAOesoTHLtbeFOCeniGHEdorOTSyanDTZtoaNDEhelIOYwerETTredANOlayDOHnupONEhegRADsanDFPllaSLPepwITStheWOZdmaNAYdthESNareCRZwkeEPTngwATNh
</span></span></code></pre></div><p>You can see a few &rsquo;the&rsquo;s in lowercase. That&rsquo;s the most common <a href=https://en.wikipedia.org/wiki/Trigram>trigram</a> in english. But the rest is still hard to determine.</p><p>Let&rsquo;s try on the other found file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat found2 | python3 decrypt-viginere-ciphertext.py AAAaaa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>THPyweREZbliGEOtocAMAoutTHLtniGHEundERLlarGEEreeINEhefORPstfOREherEWPrenOHZuseSNPartHEEreeMAOeagOOOthiCKNoveRIYgtoPRZt
</span></span></code></pre></div><p>The beginning looks like &ldquo;they were&rdquo;.</p><p>Wait, I just had an idea!</p><p>Why not ask Copilot to determine the english words?! Its trained to guess the next word - that&rsquo;s what it does!</p><h2 id=play-to-copilots-strengths>Play To Copilot&rsquo;s Strengths</h2><p>We can highlight the partially decrypted ciphertext in the terminal and ask:</p><blockquote><p>&ldquo;guess the sentence of plaintext in the terminal&rdquo;</p></blockquote><p><img src=image-12.png alt="alt text"></p><p>Insightful! Let&rsquo;s figure out the 3rd character of the key.</p><p>For that we need a reminder of the ciphertext character in column 3 of <code>found2</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat found2 | tr -d <span style=color:#e6db74>&#39; &#39;</span> | fold -w <span style=color:#ae81ff>6</span> | head -1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>YYIIAC
</span></span></code></pre></div><p>Column 3 is &lsquo;I&rsquo;. Now we can apply the <code>calculate_shift</code> function in an interactive python interpreter on ciphertext &lsquo;I&rsquo;. We&rsquo;ll assume its plaintext &lsquo;E&rsquo; in plaintext &ldquo;thEyweRE&rdquo;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>python3
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>Python <span style=color:#ae81ff>3.10.12</span> (main, Sep <span style=color:#ae81ff>11</span> <span style=color:#ae81ff>2024</span>, <span style=color:#ae81ff>15</span>:<span style=color:#ae81ff>47</span>:<span style=color:#ae81ff>36</span>) [GCC <span style=color:#ae81ff>11.4.0</span>] on linux
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#34;help&#34;</span>, <span style=color:#e6db74>&#34;copyright&#34;</span>, <span style=color:#e6db74>&#34;credits&#34;</span> <span style=color:#f92672>or</span> <span style=color:#e6db74>&#34;license&#34;</span> <span style=color:#66d9ef>for</span> more information<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_shift</span>(most_frequent_letter, reference_letter<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;E&#39;</span>):
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     alphabet <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span>ascii_uppercase
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     shift <span style=color:#f92672>=</span> (alphabet<span style=color:#f92672>.</span>index(most_frequent_letter) <span style=color:#f92672>-</span> alphabet<span style=color:#f92672>.</span>index(reference_letter)) <span style=color:#f92672>%</span> <span style=color:#ae81ff>26</span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     <span style=color:#66d9ef>return</span> shift
</span></span><span style=display:flex><span><span style=color:#f92672>...</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> calculate_shift(<span style=color:#e6db74>&#39;I&#39;</span>, <span style=color:#e6db74>&#39;E&#39;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ae81ff>4</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> string<span style=color:#f92672>.</span>ascii_uppercase[<span style=color:#ae81ff>4</span>]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#39;E&#39;</span>
</span></span></code></pre></div><p>So the shift for column 3 is 4. Starting from &lsquo;A&rsquo; and counting 4, brings us to &lsquo;E&rsquo;.</p><p>Let&rsquo;s apply that to key with the confidence boosting technique of lowercase letters!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat found2 | python3 decrypt-viginere-ciphertext.py aaeaaa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>theywereobligedtocampoutthatnightunderalargetreeintheforestfortherewerenohousesnearthetree
</span></span></code></pre></div><p>Yes! that makes sense - and Copilot was not far off in guessing the sentence - way better than me!</p><p>We&rsquo;ll decrypt <code>found1</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat found1 | python3 decrypt-viginere-ciphertext.py aaeaaa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>thesoldierwiththegreenwhiskersledthemthroughthestreetsoftheemeraldcityuntiltheyreachedtheroomwheretheguardianofthegateslivedthisofficerunlockedtheirspectaclestoputthembackinhisgreatboxandthenhepolitelyopenedthegateforourfriendswhichroadleadstothewickedwitchofthewestaskeddorothythereisnoroadansweredtheguardianofthegatesnooneeverwishestogothatwayhowthenarewetofindherinquiredthegirlthatwillbeeasyrepliedthemanforwhensheknowsyouareinthecountryofthewinkiesshewillfindyouandmakeyouallherslavesperhapsnotsaidthescarecrowforwemeantodestroyherohthatisdifferentsaidtheguardianofthegatesnoonehaseverdestroyedherbeforesoinaturallythoughtshewouldmakeslavesofyouasshehasoftherestbuttakecareforsheiswickedandfierceandmaynotallowyoutodestroyherkeeptothewestwherethesunsetsandyoucannotfailtofindhertheythankedhimandbadehimgoodbyeandturnedtowardthewestwalkingoverfieldsofsoftgrassdottedhereandtherewithdaisiesandbuttercupsdorothystillworetheprettysilkdressshehadputoninthepalacebutnowtohersurpriseshefounditwasnolongergreenbutpurewhitetheribbonaroundtotosneckhadalsolostitsgreencolorandwasaswhiteasdorothysdresstheemeraldcitywassoonleftfarbehindastheyadvancedthegroundbecamerougherandhillierfortherewerenofarmsnorhousesinthiscountryofthewestandthegroundwasuntilledintheafternoonthesunshonehotintheirfacesfortherewerenotreestoofferthemshadesothatbeforenightdorothyandtotoandthelionweretiredandlaydownuponthegrassandfellasleepwiththewoodmanandthescarecrowkeepingwatch
</span></span></code></pre></div><p>Finally, let&rsquo;s decrypt the password for the next level</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat krypton5 | python3 decrypt-viginere-ciphertext.py aaeaaa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>&lt;REDACTED&gt;
</span></span></code></pre></div><p>Wowzas! That was fun! Thanks Copilot!</p><h2 id=takeaways-for-next-time>Takeaways For Next Time&mldr;</h2><ol><li>If not already there, copy context into the IDE and open the files.</li><li>Reference the problem statement/question explicitly and chat with Copilot at a high level to get a plan.</li><li>Trade off feeding it all the context vs applying the context you know to the responses.</li><li>Iterate on the solution. Ask for small changes incrementally.</li><li>Ask for help with the parts you&rsquo;re stuck on. Copilot is a great Cryptanalyst - good at guessing the next word in a sentence.</li><li>Have fun!</li></ol></div><div class=after-post-tags><ul class=tags><li><a href=/tags/github>github</a></li><li><a href=/tags/copilot>copilot</a></li><li><a href=/tags/pair-programming>pair-programming</a></li><li><a href=/tags/ctf>ctf</a></li><li><a href=/tags/cybersecurity>cybersecurity</a></li><li><a href=/tags/security>security</a></li><li><a href=/tags/overthewire>overthewire</a></li><li><a href=/tags/problem-solving>problem-solving</a></li></ul></div><div class="row PageNavigation d-flex justify-content-between font-weight-bold"><a class="d-block col-md-6 text-lg-right" href=https://www.douglashellinger.com/blog/standardising-private-registry-configuration/>Standardising Private Registry Configuration &#187;</a><div class=clearfix></div></div></div></div></div><div class=container><div id=comments class="row justify-content-center mb-5"><div class=col-md-8></div></div></div></div></div><div class="jumbotron fortags"><div class="d-md-flex h-100"><div class="col-md-4 transpdark align-self-center text-center h-100"><div class="d-md-flex align-items-center justify-content-center h-100"><h2 class="d-md-block d-none align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2></div></div><div class="col-md-8 p-5 align-self-center text-center"><a class="mt-1 mb-1" href=/tags/build-pipeline>build-pipeline</a>
<a class="mt-1 mb-1" href=/tags/builder-image>builder-image</a>
<a class="mt-1 mb-1" href=/tags/chart>chart</a>
<a class="mt-1 mb-1" href=/tags/cloud>cloud</a>
<a class="mt-1 mb-1" href=/tags/container>container</a>
<a class="mt-1 mb-1" href=/tags/containers>containers</a>
<a class="mt-1 mb-1" href=/tags/copilot>copilot</a>
<a class="mt-1 mb-1" href=/tags/crd>crd</a>
<a class="mt-1 mb-1" href=/tags/cri>cri</a>
<a class="mt-1 mb-1" href=/tags/ctf>ctf</a>
<a class="mt-1 mb-1" href=/tags/cybersecurity>cybersecurity</a>
<a class="mt-1 mb-1" href=/tags/deployment>deployment</a>
<a class="mt-1 mb-1" href=/tags/distribution>distribution</a>
<a class="mt-1 mb-1" href=/tags/docs-as-code>docs-as-code</a>
<a class="mt-1 mb-1" href=/tags/driver>driver</a>
<a class="mt-1 mb-1" href=/tags/encryption>encryption</a>
<a class="mt-1 mb-1" href=/tags/github>github</a>
<a class="mt-1 mb-1" href=/tags/gpg>gpg</a>
<a class="mt-1 mb-1" href=/tags/helm>helm</a>
<a class="mt-1 mb-1" href=/tags/kubernetes>kubernetes</a>
<a class="mt-1 mb-1" href=/tags/medium>medium</a>
<a class="mt-1 mb-1" href=/tags/oci>oci</a>
<a class="mt-1 mb-1" href=/tags/overthewire>overthewire</a>
<a class="mt-1 mb-1" href=/tags/pair-programming>pair-programming</a>
<a class="mt-1 mb-1" href=/tags/problem-solving>problem-solving</a>
<a class="mt-1 mb-1" href=/tags/proxy>proxy</a>
<a class="mt-1 mb-1" href=/tags/registry>registry</a>
<a class="mt-1 mb-1" href=/tags/runtime>runtime</a>
<a class="mt-1 mb-1" href=/tags/security>security</a>
<a class="mt-1 mb-1" href=/tags/sigstore>sigstore</a>
<a class="mt-1 mb-1" href=/tags/thinkpad>thinkpad</a>
<a class="mt-1 mb-1" href=/tags/troubleshooting>troubleshooting</a>
<a class="mt-1 mb-1" href=/tags/ubuntu>ubuntu</a>
<a class="mt-1 mb-1" href=/tags/verify>verify</a>
<a class="mt-1 mb-1" href=/tags/writing>writing</a></div></div></div><footer class=footer><div class=container><div class=row><div class="col-md-6 col-sm-6 text-center text-lg-left">&copy; Copyright Douglas Hellinger 2022 - 2023</div><div class="col-md-6 col-sm-6 text-center text-lg-right"><a target=_blank rel=noopener href=https://www.wowthemes.net>Mediumish Theme</a> by WowThemes.net</div></div></div></footer></div><script src=https://code.jquery.com/jquery-3.4.1.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js integrity=sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script>
<script src=https://www.douglashellinger.com/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TEH3VGXMRY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TEH3VGXMRY",{anonymize_ip:!1})}</script></body></html>